<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="google-site-verification" content="1Zy00azq9cEpEdA8tlQKSs2ojR5LkDjrO2fYPbkn7uk">
<meta name="description" content="Winnick Connection is a student-built campus platform that helps students connect, share profiles, and communicate easily.">
<meta name="keywords" content="Winnick Connection, campus students, student profiles, Zambian college students">
<meta name="robots" content="index, follow">

<title>Winnick Connection</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">

<style>
/* ---- YOUR ORIGINAL STYLES (UNCHANGED) ---- */
body{font-family:"Segoe UI",Arial,sans-serif;background:linear-gradient(to right,#e3f2fd,#f9fbfd);margin:0}
header{background:linear-gradient(135deg,#1e88e5,#1565c0);color:white;padding:30px 20px;text-align:center}
.card{background:white;padding:20px;margin-bottom:20px;border-radius:12px;box-shadow:0 10px 25px rgba(0,0,0,.08)}
button{background:#1e88e5;color:white;border:none;border-radius:8px;padding:10px;cursor:pointer}
.whatsapp-btn{background:#25D366;color:white;padding:6px 10px;border-radius:6px;text-decoration:none;font-weight:bold}
.page{display:none}
</style>
</head>

<body>

<header>
  <button onclick="showPage('homePage')">Home</button>
  <button onclick="showPage('profilePage')">Add Profile</button>
  <button onclick="showPage('profilesPage')">Profiles</button>
  <h1>Winnick Connection</h1>
  <p>Meet and connect with students on campus</p>
</header>

<main>

<div class="card page" id="homePage" style="display:block">
  <h2>Welcome</h2>
  <p>Connect with fellow students.</p>
</div>

<div class="card page" id="profilePage">
  <h2>Create Profile</h2>
  <input id="name" placeholder="Name">
  <input id="course" placeholder="Course">
  <input id="contact" placeholder="Contact">
  <textarea id="about" placeholder="About"></textarea>
  <input type="file" id="photo">
  <button onclick="addProfile()">Add Profile</button>
  <p id="successMsg" style="display:none;color:green">Profile added!</p>
</div>

<div class="card page" id="profilesPage">
  <h2>Student Profiles</h2>
  <input id="search" placeholder="Search..." onkeyup="searchProfiles()">
  <div id="profiles"></div>
</div>

</main>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

<script>
const firebaseConfig = {
  apiKey: "AIzaSyBwLrCKI3pFQGBp9RHunEOMchratxl5va0",
  authDomain: "winnickconnection.firebaseapp.com",
  databaseURL: "https://winnickconnection-default-rtdb.firebaseio.com",
  projectId: "winnickconnection"
};

firebase.initializeApp(firebaseConfig);
const database = firebase.database();
const profilesRef = database.ref("profiles");

function addProfile(){
  const name=name.value, course=course.value, contact=contact.value, about=about.value;
  if(!name||!course||!contact){alert("Fill required fields");return;}
  profilesRef.push({name,course,contact,about,photo:""});
  successMsg.style.display="block";
  setTimeout(()=>successMsg.style.display="none",3000);
}

function searchProfiles(){
  const t=search.value.toLowerCase();
  document.querySelectorAll("#profiles .card").forEach(c=>{
    c.style.display=c.innerText.toLowerCase().includes(t)?"block":"none";
  });
}

/* ================= FIXED RENDERING LOGIC ================= */
profilesRef.on("value", snapshot=>{
  const container=document.getElementById("profiles");
  container.innerHTML="";

  snapshot.forEach(child=>{
    const p=child.val();
    const div=document.createElement("div");
    div.className="card";

    div.innerHTML=`
      <div style="display:flex;gap:10px;align-items:center">
        ${p.photo?`<img src="${p.photo}" loading="lazy" style="width:60px;height:60px;border-radius:50%">`:""}
        <div>
          <h3>${p.name}</h3>
          <p>${p.course}</p>
          <a class="whatsapp-btn" href="https://wa.me/260${p.contact.replace(/\D/g,'')}">WhatsApp</a>
        </div>
      </div>`;
    container.appendChild(div);
  });
});
/* ======================================================== */

function showPage(id){
  document.querySelectorAll(".page").forEach(p=>p.style.display="none");
  document.getElementById(id).style.display="block";
}
</script>

</body>
</html>
